---
title: "Simple metrics of biodiversity demonstrations"
output: 
    github_document:
        toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.dim = c(4, 3))
library(dplyr)
library(ggplot2)
theme_set(theme_bw())
```

## Data

Get an SAD (here, using the `meteR::arth` data; substitute here to use a different community)

```{r}

sad_long <- meteR::arth

sad_counts <- sad_long %>%
  group_by(spp) %>%
  tally() %>%
  arrange(desc(n)) %>%
  mutate(rank = dplyr::row_number()) %>%
  rename(abundance = n) %>%
  select(rank, abundance)

head(sad_counts)

```

## Visualizing SADs

### Histogram

```{r}

sad_histogram <- ggplot(sad_counts, aes(abundance)) +
  geom_histogram() +
  xlab("Abundance") +
  ylab("Frequency") +
  ggtitle("Histogram")

sad_histogram
```

### Rank-abundance plot

```{r}

sad_rankplot <- ggplot(sad_counts, aes(rank, abundance)) +
  geom_point() +
  geom_line() +
  xlab("Rank") +
  ylab("Abundance") +
  ggtitle("Rank-abundance plot")


sad_rankplot




sad_rankplot_log <- ggplot(sad_counts, aes(log(rank), log(abundance))) +
  geom_point() +
  geom_line() +
  xlab("Rank (log)") +
  ylab("Abundance (log)") +
  ggtitle("Rank-abundance plot (log-log)") 


sad_rankplot_log
```

### Cumulative distribution function

```{r}

sad_ecdf <- ecdf(sad_counts$abundance)

sad_counts <- sad_counts %>%
  mutate(cdf = sad_ecdf(abundance))

cdf_plot <- ggplot(sad_counts, aes(abundance, cdf)) + 
  geom_point() +
  geom_line() +
  xlab("Abundance") +
  ylab("Cumulative density") +
  ggtitle("CDF")

cdf_plot


cdf_plot_log <- ggplot(sad_counts, aes(log(abundance), cdf)) + 
  geom_point() +
  geom_line() +
  xlab("Abundance (log)") +
  ylab("Cumulative density") +
  ggtitle("CDF (log)")

cdf_plot_log

```

## Fitted distributions

## Summary statistics

* Richness
* Evenness/diversity

****

* Hill numbers

https://cran.r-project.org/web/packages/hillR/hillR.pdf
